/**
 * @file product-list.ts
 * @description Component to display a list of phone products. Fetches product data, renders product cards, and includes filtering/sorting functionalities.
 */

import { Product } from './types'; // Import the Product type
import { getProducts } from './api-mock'; // Import the function to fetch products
import { renderProductCard } from './components'; // Import the function to render a product card

/**
 * Renders the list of products into the DOM.
 * @async
 * @function renderProductList
 * @param {HTMLElement} parentElement - The HTML element where the product list will be rendered.
 * @returns {Promise<void>}
 */
async function renderProductList(parentElement: HTMLElement): Promise<void> {
  try {
    const products: Product[] = await getProducts();

    // Create a container for the product cards
    const productListContainer = document.createElement('div');
    productListContainer.classList.add('grid', 'grid-cols-1', 'sm:grid-cols-2', 'md:grid-cols-3', 'lg:grid-cols-4', 'gap-4');

    // Render each product card and append it to the container
    products.forEach(product => {
      const productCard = renderProductCard(product);
      productListContainer.appendChild(productCard);
    });

    // Append the product list container to the parent element
    parentElement.appendChild(productListContainer);
  } catch (error) {
    console.error('Error rendering product list:', error);
    parentElement.textContent = 'Failed to load products.';
  }
}

/**
 * Initializes the product list component.
 * @function initProductList
 * @param {string} elementId - The ID of the HTML element where the product list will be rendered.
 * @returns {void}
 */
function initProductList(elementId: string): void {
  const parentElement = document.getElementById(elementId);

  if (!parentElement) {
    console.error(`Element with ID "${elementId}" not found.`);
    return;
  }

  renderProductList(parentElement);
}

// Export the initProductList function so it can be used in other modules
export { initProductList };

// Example usage: Assuming you have an element with id "product-list-container" in your HTML
// initProductList('product-list-container');